<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" /><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1039.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","queueTime":0,"licenseKey":"cd1101aa94","agent":"","transactionName":"bgcDMkBZW0NZBkdcWVdNJxNcW0FZVwscV1dKB08QW11CQxYTWlBBZgEOC19dW0QCEVtHU1gG","applicationID":"6369297","errorBeacon":"bam.nr-data.net","applicationTime":104}</script>
    <title>UniChem Mapping to LINCS Small Molecules | Thinklab</title>
	  <link rel="shortcut icon" href="https://think-lab.s3.amazonaws.com/s/img/favicon.ico" type="image/x-icon" />
    <meta property="og:image" content="https://think-lab.s3.amazonaws.com/s/img" />
    
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" />

<link rel="stylesheet" href="https://think-lab.s3.amazonaws.com/s/highlightjs/github.css" />
<link rel="stylesheet" href="https://think-lab.s3.amazonaws.com/s/css/css.css" />
<link rel="stylesheet" href="https://think-lab.s3.amazonaws.com/s/css/bootstrap-multiselect.css" />
<!-- <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'> -->

    
    
    
    
  
    <meta name="citation_doi" content="10.15363/thinklab.d51">
    <meta name="citation_title" content="UniChem Mapping to LINCS Small Molecules">
    <meta name="citation_online_date" content="April 8, 2015">
    <meta name="citation_author" content="Leo Brueggeman, Daniel Himmelstein, Caty Chung">
    <meta name="citation_journal_title" content="Thinklab">
    <meta name="citation_publisher" content="Thinklab">
  

    


	<!-- GoogleAnalytics -->
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-48550230-1', 'thinklab.com');
	ga('require', 'displayfeatures');
	
	ga('send', 'pageview');

	</script>






</head>
<body >
  <form id="form_action" method="post">
    <input type='hidden' name='csrfmiddlewaretoken' value='pQNiZQX4gF2vyFeXrnbUl9EmuTWA5MG1' />
</form>

	

	<div class="body-wrapper">

		


<!-- <div style="height:5px;background-image:url('https://think-lab.s3.amazonaws.com/s/img/top-bg.gif');"></div> -->
<div class="gradient">
	<div class="main-centered-div header-container">

<table class="full-width" style="height:60px;"><tr>
	<td style="width:200px;vertical-align:middle;padding-bottom:15px;">
		<a href="/" style="font-weight:normal;color:#212121;"><img src="https://think-lab.s3.amazonaws.com/s/img/logo.png" width="160"></a>
	</td><td style="vertical-align:middle;text-align:left;padding-top:6px;width:100%;padding-left:40px;">
		<ul id="not-search-block"  class="main-header">


			


				<li class="dropdown">
					<a class="dropdown-toggle" data-toggle="dropdown" href="#">Browse <span class="caret"></span></a>
					<ul class="dropdown-menu" role="menu">
						<li><a href="/proposals">Proposals</a></li>
						<li><a href="/projects">Projects</a></li>
						<li><a href="/publications">Article discussion</a></li>
						<li><a href="/discussion">All discussion</a></li>
					</ul>
				</li>
				<li><a href="/leaderboard">Leaderboard</a></li>

			
				<li><a href="/about">About</a></li>
			


		</ul>

    <ul id="search-block" class="main-header" style="display: none; margin-right: 30px;">
        <li class="full-width">
            <form method="get" action="/search">
			<div class="input-group full-width">
				<input name="q" type="text" class="form-control search-input">
			</div>
            </form>
        </li>
    </ul>

	</td><td style="vertical-align:middle;text-align:right;padding-top:6px; min-width: 1%; white-space: nowrap;">
		<ul class="main-header pull-right" style="padding-left: 0;">
    		
                <li><a href="/login" style="color:silver;">Login</a></li>
                <li style="margin-right:0"><a class="btn btn-default btn-sm btn-upper" href="/signup">Join</a></li>
            

        </ul>
    </ul>
	</td>
</tr></table>

<!-- <div id="global-search-div" class="main-centered-div" style="display:none;">
	<input type="text" value="" class="thread-search form-control" placeholder="Search" data-action="/discussion">
</div> -->

	</div>
</div>

		
	  



	  


		

		<div class="dark-head"><div class="main-centered-div">

			

		</div></div>
		
		<div class="main-centered-div" style="margin-top:40px;padding-bottom:340px">
	    

<div style="margin-top:-20px; margin-bottom:20px;">

    <a class="side-box" href="/p/rephetio" style="background-color:#ebfdff;"><div class="side-type">Project:</div> <div class="side-title">Rephetio: Repurposing drugs on a hetnet [rephetio]</div></a><br>



</div>

<table style="margin-top:0px;"><tr>
	<td class="thread-table-content">

		<table class="full-width">
			
<tr class="comment-tr target-hl" id="1" data-comment-id="122">
  <td class="comment-profile-avatar">
		<a href="/u/leobrueggeman"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/m/profile/21_medium.jpg' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="122"></a>

    

			<h2 class="page-title" style="margin-bottom:5px;margin-top:0px !important;">UniChem Mapping to LINCS Small Molecules</h2>

			<div style="margin-top:5px;color:gray;margin-bottom:20px;font-size:13px;">
				<a style="font-weight:normal;color:#212121" href="/u/leobrueggeman"><strong>Leo Brueggeman</strong></a>
				<span class="is-researcher">Researcher</span>
				&nbsp; <a href="#1" class="light">820 days ago</a>
				
			</div>

      

          <hr>
		

    <p>While <a href="http://nbviewer.ipython.org/url/git.dhimmel.com/drugbank/unichem-map.ipynb">mapping</a> DrugBank compounds to LINCS, we have noticed that UniChem's mapping is potentially outdated. UniChem maps to LINCS compound identifiers that begin with <code>LSM-</code> while the current LINCS small molecule identifiers (called <code>pert_id</code>) begin with <code>BRD-</code>.</p>

<p>UniChem searches that match to LINCS, hyperlink to the <a href="http://life.ccs.miami.edu/life/">LIFE resource</a>, which is not up to date with the released LINCS data (<a href="https://www.ebi.ac.uk/unichem/frontpage/results?queryText=ULSMZGGENQYXHL-UHFFFAOYSA-N&amp;kind=InChIKey&amp;sources=&amp;incl=exclude">example search</a> and <a href="http://life.ccs.miami.edu/life/summary?mode=SmallMolecule&amp;source=LINCS&amp;input=LSM-3295">example link</a>).</p>

<p>LIFE contains ~9000 small molecules versus &gt;20000 at LINCS and also does not consistently supply the main pert_id used by LINCS. The <code>LINCS ID</code> used by LIFE doesn't appear in the compound information that is currently obtainable from the LINCS API, so it may be an obsolete ID system replaced by pert_id.</p>

<p>We will contact UniChem to alert them and will solicit feedback from the LINCS team regarding the ID confusion.</p>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="2" data-comment-id="123">
  <td class="comment-profile-avatar">
		<a href="/u/dhimmel"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/m/profile/17_medium.jpg' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="123"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/dhimmel">Daniel Himmelstein</a>
				<span class="is-researcher">Researcher</span>
				<span class="light">&nbsp;<a href="#2" class="light">820 days</a>
          
        </span>
      </div>

    

    <p>Perhaps this explains why 39% of DrugBank approved small molecules <a href="http://git.dhimmel.com/drugbank/unichem-map.html">did not map</a> to a single LINCS compound: the LINCS resource was half it's current size.</p>

<p>Until this issue is resolved, we have two workarounds:</p>

<ol><li>Identify LINCS small molecules with their PubChem identifiers, which are provided for most compounds.</li><li>Match LINCS compounds to DrugBank using the provided InChIKeys and UniChem.</li></ol>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="3" data-comment-id="132">
  <td class="comment-profile-avatar">
		<a href="/u/cchung"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/s/img/p_default_medium.png' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="132"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/cchung">Caty Chung</a>
				
				<span class="light">&nbsp;<a href="#3" class="light">816 days</a>
          
        </span>
      </div>

    

    <p>The <a href="http://lincs-dcic.org/">BD2K-LINCS Data Coordination and Integration Center</a>  is part of the Big Data to Knowledge (BD2K) NIH initiative, and it is the data coordination center for the NIH Common Fund's Library of Integrated Network-based Cellular Signatures (LINCS) program, which aims to characterize how a variety of human cells, tissues and the entire organism respond to perturbations by drugs and other molecular factors. </p>

<p>The <a href="http://www.lincsproject.org/centers/bd2k-lincs-dcic/">BD2K- LINCS DCIC</a> works closely with each <a href="http://www.lincsproject.org/centers/data-and-signature-generating-centers/">LINCS Data and Signature Generation Centers (DSGC)</a>. The DCIC also collaborates with other other organizations and projects like EBI (UniChem, ChEMBL, ChEBI), PubChem.<br>The LINCS Production Phase (LP2) DSGC's are:<br>-  Drug Toxicity Signature Generation Center (Icahn School of Medicine at Mount Sinai)<br>-  HMS LINCS Center (Harvard Medical School)<br>-  LINCS Center for Transcriptomics (Broad Institute)<br>-  LINCS Proteomic Characterization Center for Signaling and Epigenetics (Broad Institute)<br>-  Microenvironment Perturbagen (MEP) LINCS Center (Oregon Health and Science University)<br>-  NeuroLINCS Center (University of California, Irvine)</p>

<p>The UniChem chemical structure cross-reference is mapped against the standardized LINCS small molecule (LSM).  The DCIC uses a simple schema to combine LINCS and other data into a coherent and computable knowledge framework. The Center develops meta-data standards that enable data integration and representation across the data and signature generation centers (DGSCs). Members of the DCIC are actively developing a next generation integrated web-based platform for the LINCS project that will serve as the foundation for LINCS activities and federate LINCS data, signatures, analysis algorithms, pipelines, APIs and web tools.  </p>

<p>UniChem cross-references the standardized LINCS Small Molecule ID (LSM ID).  The LSM IDs are mapped to each center's compound and / or sample identifiers.  One example of such Center-specific IDs are identifier with the prefix "BRD", which correspond to small molecule compound IDs from the LINCS Center for Transcriptomics (Broad Institute).</p>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="4" data-comment-id="138">
  <td class="comment-profile-avatar">
		<a href="/u/cchung"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/s/img/p_default_medium.png' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="138"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/cchung">Caty Chung</a>
				
				<span class="light">&nbsp;<a href="#4" class="light">814 days</a>
          
        </span>
      </div>

    

    <p>The following tables will help you map between LINCS Centers to LINCS Small Molecule ID (LSM):<br><a href="http://lincs-dcic.org/metadata/SmallMolecules/LincsID2FacilityID_LINCS_StandardizedCmpds_LSMIDs.txt">mapping of LINCS Small Molecules to LINCS Facility ID</a><br><a href="http://lincs-dcic.org/metadata/SmallMolecules/CompoundTable_LINCS_StandardizedCmpds_LSMIDs.txt">LINCS compound table</a><br><a href="http://lincs-dcic.org/metadata/SmallMolecules/SampleTable_LincsID2FacilityID2CenterBatchID_LINCS_StandardizedCmpds_LSMIDs.txt">LINCS by SM_Center_Sample_ID</a></p>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="5" data-comment-id="140">
  <td class="comment-profile-avatar">
		<a href="/u/leobrueggeman"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/m/profile/21_medium.jpg' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="140"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/leobrueggeman">Leo Brueggeman</a>
				<span class="is-researcher">Researcher</span>
				<span class="light">&nbsp;<a href="#5" class="light">814 days</a>
          
        </span>
      </div>

    

    <p><a href="/u/cchung" class="username">@cchung</a>, Thank you for the useful links. Looking into the file you linked to named <a href="http://lincs-dcic.org/metadata/SmallMolecules/LincsID2FacilityID_LINCS_StandardizedCmpds_LSMIDs.txt">mapping of LINCS Small Molecules to LINCS Facility ID</a> (<code>LincsID2FacilityID_LINCS_StandardizedCmpds_LSMIDs.txt</code>), we found that it contained 35,305 <code>BRD-</code> small molecule perturbagen IDs. Separate from this, we have a smaller set of <code>BRD-</code> small molecule perturbagen IDs (20,413) extracted from the <a href="http://api.lincscloud.org/">LINCS L1000 API</a>. In comparing these two sets, we found only 13,796 common <code>BRD-</code> IDs.</p>

<p>This means that many of the <code>BRD-</code> small molecule perturbagen IDs mapped to <code>LSM</code> IDs do not have transcriptional profiles from Broad. Additionally many compounds that were transcriptionally profiled are not mapped to the <code>LSM</code> ID set.</p>

<p>Therefore, to integrate <code>BRD</code> compounds, we will rely on the supplied pubchem CIDs, which almost all compounds had.</p>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="6" data-comment-id="141">
  <td class="comment-profile-avatar">
		<a href="/u/cchung"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/s/img/p_default_medium.png' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="141"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/cchung">Caty Chung</a>
				
				<span class="light">&nbsp;<a href="#6" class="light">813 days</a>
          
        </span>
      </div>

    

    <p>The count difference is because the <a href="http://www.lincscloud.org/perturbagens/">L1000 dataset contains  20,413 small-molecules</a> profiled as part of the LINCS program, the Broad Connectivity Map, NIH efforts such as CDRP, and other projects.  We are standardizing the remaining - will keep you posted on the release!</p>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="7" data-comment-id="228">
  <td class="comment-profile-avatar">
		<a href="/u/dhimmel"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/m/profile/17_medium.jpg' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="228"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/dhimmel">Daniel Himmelstein</a>
				<span class="is-researcher">Researcher</span>
				<span class="light">&nbsp;<a href="#7" class="light">779 days</a>
          
        </span>
      </div>

    

    <p>I came across the following paper that has useful information regarding the LINCS data integration standards:</p>

<blockquote><p>Metadata Standard and Data Exchange Specifications to Describe, Model, and Integrate Complex and Diverse High-Throughput Screening Data from the Library of Integrated Network-based Cellular Signatures (LINCS). <span class="citation">[<a href="https://doi.org/10.1177/1087057114522514" class="citation" data-key="10.1177/1087057114522514">1</a>]</span></p></blockquote>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

<tr class="comment-tr target-hl" id="8" data-comment-id="1151">
  <td class="comment-profile-avatar">
		<a href="/u/dhimmel"><img class='profile_image photo-medium' src='https://think-lab.s3.amazonaws.com/m/profile/17_medium.jpg' width='60' height='60'></a>
  </td>
	<td class="comment-body">
    <a name="1151"></a>

    

      <div class="comment-header">
        <a style="font-weight:bold;color:#212121" href="/u/dhimmel">Daniel Himmelstein</a>
				<span class="is-researcher">Researcher</span>
				<span class="light">&nbsp;<a href="#8" class="light">486 days</a>
          
        </span>
      </div>

    

    <h1>Method for mapping L1000 compounds to external vocabularies</h1>

<p>We chose to map LINCS L1000 compounds to external vocabularies by querying UniChem with the InChIKey of each L1000 compound (strategy 2 <a href="#2">above</a>). This approach enabled us to map L1000 compounds not only to DrugBank, but also to the other vocabularies covered by UniChem.</p>

<p>The InChIKey for each L1000 compound was retrieved from the <a href="http://api.lincscloud.org/a2/docs/pertinfo" title="L1000 pertinfo API">L1000 API</a> (<a href="https://github.com/dhimmel/lincs/blob/093dc3a0497028ad2b9549a3f9fa12f8ce38461f/api.ipynb" title="api.ipynb in the dhimmel/lincs GitHub repository">notebook</a>). Only perturbations with <code>pert_type == 'trt_cp'</code> and a non-null <code>inchi_key</code> were mapped. We queried the <a href="https://www.ebi.ac.uk/unichem/info/widesearchInfo" title="Connectivity Search Documentation">UniChem API</a> for each L1000 InChIKey to retrieve matches (<a href="https://github.com/dhimmel/lincs/blob/093dc3a0497028ad2b9549a3f9fa12f8ce38461f/unichem.ipynb" title="unichem.ipynb in the dhimmel/lincs GitHub repository">notebook</a>).</p>

<p>We used the same UniChem Connectivity Search parameters that we <a href="http://thinklab.com/discussion/unifying-drug-vocabularies/40#5" class="citation thread-citation" data-key="10.15363/thinklab.d40">used for mapping DrugBank</a>. Our search permissively matches compounds by atomic structure, ignoring small molecular details <span class="citation">[<a href="https://doi.org/10.1186/s13321-014-0043-5" class="citation" data-key="10.1186/s13321-014-0043-5">1</a>]</span>. We store all the UniChem output in our SQLite database (<code>l1000.db</code> <span class="citation">[<a href="https://doi.org/10.6084/m9.figshare.3085837.v1" class="citation" data-key="10.6084/m9.figshare.3085837.v1">2</a>]</span>, <code>unichem</code> table), so users could later choose more restrictive parameters without having to requery UniChem.</p>

		<div style="margin-left:30px;">

      


      <ul class="comment-notes">
				
				
			</ul>

      

		</div>

		


  </td>
</tr>

    		
		</table>

    

    &nbsp;<br>
    <a class="btn btn-primary btn-lg" href="/signup?next=/discussion/unichem-mapping-to-lincs-small-molecules/51&suppress_message=1" style>Join to Reply</a>


		<table class="references table-td-5" style="display:none;"><tr><td><a href='/doi/10.1177/1087057114522514' class='pub-comments tt-right zero-items' title='Article comments'>0</a></td><td><div class='pub-order'>1.</div></td><td><div class='doi-body' data-key='10.1177/1087057114522514'><a href='/doi/10.1177/1087057114522514' class='pub-title'>Metadata Standard and Data Exchange Specifications to Describe, Model, and Integrate Complex and Diverse High-Throughput Screening Data from the Library of Integrated Network-based Cellular Signatures (LINCS)</a><div class='pub-body'>U. D. Vempati, C. Chung, C. Mader, A. Koleti, N. Datar, D. VidoviÂ , D. Wrobel, S. Erickson, J. L. Muhlich, G. Berriz, C. H. Benes, A. Subramanian, A. Pillai, C. E. Shamu, S. C. Schurer (2014) <i>Journal of Biomolecular Screening</i>. doi:<a class='pub-doi' href='https://doi.org/10.1177/1087057114522514'>10.1177/1087057114522514</a></div></div></td></tr><tr><td><a href='/doi/10.1186/s13321-014-0043-5' class='pub-comments tt-right zero-items' title='Article comments'>0</a></td><td><div class='pub-order'>2.</div></td><td><div class='doi-body' data-key='10.1186/s13321-014-0043-5'><a href='/doi/10.1186/s13321-014-0043-5' class='pub-title'>UniChem: extension of InChI-based compound mapping to salt, connectivity and stereochemistry layers</a><div class='pub-body'>Jon Chambers, Mark Davies, Anna Gaulton, George Papadatos, Anne Hersey, John P Overington (2014) <i>Journal of Cheminformatics</i>. doi:<a class='pub-doi' href='https://doi.org/10.1186/s13321-014-0043-5'>10.1186/s13321-014-0043-5</a></div></div></td></tr><tr><td><a href='/doi/10.6084/m9.figshare.3085837.v1' class='pub-comments tt-right zero-items' title='Article comments'>0</a></td><td><div class='pub-order'>3.</div></td><td><div class='doi-body' data-key='10.6084/m9.figshare.3085837.v1'><a href='/doi/10.6084/m9.figshare.3085837.v1' class='pub-title'>l1000.db: SQLite database of LINCS L1000 metadata</a><div class='pub-body'>Daniel Himmelstein, Leo Brueggeman, Sergio Baranzini (2016) <i>Figshare</i>. doi:<a class='pub-doi' href='https://doi.org/10.6084/m9.figshare.3085837.v1'>10.6084/m9.figshare.3085837.v1</a></div></div></td></tr><tr style=&#39;display:none;&#39;><td><a href='/doi/10.15363/thinklab.d40' class='pub-comments tt-right zero-items' title='Article comments'>0</a></td><td><div class='pub-order'>4.</div></td><td><div class='doi-body' data-key='10.15363/thinklab.d40'><a href='/discussion/unifying-drug-vocabularies/40' class='pub-title'>Unifying drug vocabularies</a><div class='pub-body'>Daniel Himmelstein (2015) <i>Thinklab</i>. doi:<a href='https://doi.org/10.15363/thinklab.d40'>10.15363/thinklab.d40</a></div></div></td></tr></table>

    


	</td>
	<td class="thread-sidebar">


			

      <a class="btn btn-default follow-link btn-follow btn-lg is-following tt-top full-width" title="Follow discussion" data-id="51" data-ctype="thread" data-is-following="false">&nbsp;</a>

      
        <div class="status-box text-center"><span style="">Status:</span> 
  Completed

</div>
      

      
        
      


				

					<div class="details">Views</div>
					<span style="font-size:20px;">450</span>

        

				
					<div class="details">Topics</div>
					<div style="margin-bottom:15px;">
		            <a href="/topics/mapping" class="tag">Mapping</a><a href="/topics/unichem" class="tag">UniChem</a><a href="/topics/lincs" class="tag">LINCS</a>
					</div>
				


		
			<div class="details">Referenced by</div>
			<div style="font-size:12px;"><ul style="padding-left:16px !important;">
			
				<li>
					
					<a href='/discussion/computing-consensus-transcriptional-profiles-for-lincs-l1000-perturbations/43' class='thread-title'>Computing consensus transcriptional profiles for LINCS L1000 perturbations</a>
				</li>
			
				<li>
					
					<a href='/discussion/lincs-l1000-licensing/110' class='thread-title'>LINCS L1000 licensing</a>
				</li>
			
				</ul>
			</div>
		

		
			<div class="details">Cite this as</div>
			<span style="font-size:12px;">
				Leo Brueggeman, Daniel Himmelstein, Caty Chung (2015) UniChem Mapping to LINCS Small Molecules. <i>Thinklab.</i> doi:<a href='https://doi.org/10.15363/thinklab.d51'>10.15363/thinklab.d51</a>
			</span>
		

		<div class="details">License</div>
		<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0;width:88px;height:31px;" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a></p>

		<div class="details">Share</div>
		
			
				<a class="share-button fb" onclick="javascript:void(window.open('https://www.facebook.com/sharer/sharer.php?u=https%3A//thinklab.com/discussion/unichem-mapping-to-lincs-small-molecules/51','','width=600,height=460,menubar=no,status=no'));" href="#"></a>
<a class="share-button twitter" onclick="javascript:void(window.open('https://twitter.com/share?text=UniChem%20Mapping%20to%20LINCS%20Small%20Molecules&url=https%3A//thinklab.com/discussion/unichem-mapping-to-lincs-small-molecules/51','','width=600,height=300,menubar=no,status=no'));" href="#"></a>
<a class="share-button google" onclick="javascript:void(window.open('https://plus.google.com/share?url=https%3A//thinklab.com/discussion/unichem-mapping-to-lincs-small-molecules/51','','width=510,height=460,menubar=no,status=no'));" href="#"></a>

			
		

	</td>
</tr></table>


		</div>


		
	    	<div class="footer">
<div style="background:#dedede;">
	<div class="main-centered-div text-center" style="padding:20px;">
		<h4 style="margin-bottom:0px;font-weight:bold;color:gray;">Feedback? Questions? Email us: <a href="/cdn-cgi/l/email-protection#422a272e2e2d02362a2b2c292e23206c212d2f"><span class="__cf_email__" data-cfemail="345c5158585b74405c5d5a5f5855561a575b59">[email&#160;protected]</span><script data-cfhash='f9e31' type="text/javascript">/* <![CDATA[ */!function(t,e,r,n,c,a,p){try{t=document.currentScript||function(){for(t=document.getElementsByTagName('script'),e=t.length;e--;)if(t[e].getAttribute('data-cfhash'))return t[e]}();if(t&&(c=t.previousSibling)){p=t.parentNode;if(a=c.getAttribute('data-cfemail')){for(e='',r='0x'+a.substr(0,2)|0,n=2;a.length-n;n+=2)e+='%'+('0'+('0x'+a.substr(n,2)^r).toString(16)).slice(-2);p.replaceChild(document.createTextNode(decodeURIComponent(e)),c)}p.removeChild(t)}}catch(u){}}()/* ]]> */</script></a></h4>
	</div>
</div>
<div class="main-footer">
	<div class="main-centered-div">

<table class="full-width"><tr>
	<td class="footer-nav">

        <div class="foot-head">Explore</div>
        <a href="/proposals">Proposals</a><br>
        <a href="/projects">Projects</a><br>
        <a href="/publications">Article discussion</a><br>
        <a href="/discussion">All discussion</a><br>
        <a href="/topics">Topics</a><br>
        <!-- <a href="/funders">Funders</a><br> -->
        <a href="/funding">Funding opportunities</a><br>

	</td>
	<td class="footer-nav">

        <!-- <div class="foot-head">Help &amp; feedback</div>	 -->
        <!-- <div class="foot-head">Intro</div>
        <a href="/benefits/for-science">Why</a><br>
        <a href="/how-it-works">How it works</a><br>

<br> -->

        <div class="foot-head">Community</div>
        <a href="/leaderboard">Leaderboard</a><br>
        <a href="/p/meta">Thinklab Meta</a><br>
				<a href="/help/faq">Help</a><br>
				<!-- <a href="/new-project">Start a proposal</a><br> -->
        <!-- <a href="/benefits/proposal">Benefits</a><br> -->
        <!-- <a href="/funding">Get funded</a><br> -->
        <!-- <a href="/participate">Become a contributor</a><br> -->
        <!-- <a href="/for-funders">For science funders</a><br> -->
        <!-- <a href="/for-institutions">For institutions</a><br> -->

	</td>
	<td class="footer-nav">



        <div class="foot-head">About</div>
        <a href="/about">Overview</a><br>
        <a href="/benefits">Benefits</a><br>
        <a href="/how-it-works">How it works</a><br>
        <a href="/about/story">Our story</a><br>
        <a href="/blog">Our blog</a><br>
        <a href="/about/jobs">Join the team</a><br>
        <br>

        <!-- <div class="foot-head">Help</div>
        <a href="/help">Help</a><br>
		 -->


	</td>
	<td class="footer-nav">
		<a href="http://twitter.com/thinklab" class="social-icon"><img src="https://think-lab.s3.amazonaws.com/s/img/icons/twitter_com.png" width="40"/></a>
		<a href="https://www.facebook.com/pages/Thinklab/310895039088185" class="social-icon"><img src="https://think-lab.s3.amazonaws.com/s/img/icons/facebook_com.png" width="40"/></a>
		<a href="https://plus.google.com/115578983466800753402/" class="social-icon"><img src="https://think-lab.s3.amazonaws.com/s/img/icons/plus_google_com.png" width="40"/></a>
		<a href="https://www.linkedin.com/company/thinklab-co" class="social-icon"><img src="https://think-lab.s3.amazonaws.com/s/img/icons/linkedin_com.png" width="40"/></a>
		<br><br>
		<span class="light" style='font-size:12px;'>&copy; 2015 Thinklab</span>

	</td>

</tr></table>

</div>
</div>
</div>

		

	</div>


  <script></script>
  <script>
  var MEDIA_URL = 'https://think-lab.s3.amazonaws.com/m/';
  var STATIC_URL = 'https://think-lab.s3.amazonaws.com/s/';
  var page_is_authenticated = false;
  var page_page = 'discussion';
  var page_profile_id = undefined;
</script>



	<!-- Note different script type. MUST come before MathJax.js -->
	<script type="text/x-mathjax-config">
	    MathJax.Hub.Config({
	        "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"],
	                        scale: 110, linebreaks: { automatic:true },
	                        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
	        tex2jax: { inlineMath: [ ["$$", "$$"], ["\\(","\\)"] ],
	                    displayMath: [ ["$$$","$$$"], ["\\[", "\\]"] ],
	                    processEscapes: true,}
	            });

	</script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>





  <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <script src="https://think-lab.s3.amazonaws.com/s/dist/main.min.js"></script>
  



  
	
  
  
  
<script>
$(function() {
  recordHit('thread', 51);
});
</script>



<script>/* <![CDATA[ */(function(d,s,a,i,j,r,l,m,t){try{l=d.getElementsByTagName('a');t=d.createElement('textarea');for(i=0;l.length-i;i++){try{a=l[i].href;s=a.indexOf('/cdn-cgi/l/email-protection');m=a.length;if(a&&s>-1&&m>28){j=28+s;s='';if(j<m){r='0x'+a.substr(j,2)|0;for(j+=2;j<m&&a.charAt(j)!='X';j+=2)s+='%'+('0'+('0x'+a.substr(j,2)^r).toString(16)).slice(-2);j++;s=decodeURIComponent(s)+a.substr(j,m-j)}t.innerHTML=s.replace(/</g,'&lt;').replace(/\>/g,'&gt;');l[i].href='mailto:'+t.value}}catch(e){}}}catch(e){}})(document);/* ]]> */</script></body>
</html>
